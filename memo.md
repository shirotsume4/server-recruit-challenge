# サーバーエンジニア向け 2025新卒採用事前課題

## 2023/11/11

## 課題1,課題2

- とりあえずforkして動作確認
 - GET, DELETEに関しては問題なし
 - POSTがコマンドプロンプトやPowerShellではうまくいかなかった（JSONのパースに失敗しているっぽい）
    - Postmanを利用することで事なきを得る
- 間違ってfork元にcommitしてしまわないか不安

## 課題3
- albumのAPIを作る
 - singerの部分で流用できそうなものは流用する
 - 将来的にalbumはsingerに依存することになりそう？なのでそこは注意
- importって何だろう？github.comからとってきてるのまずそう
 - ローカルからのimportに変えたけど、問題なく動いている
  - なんとなく変えなくてよかった気もするけど、もう変えてしまったのでとりあえずこのまま行く

- とりあえずいろいろ流用してきてすべて問題なく動いた

## 課題4

- 今後の実装方針だけ考えておく

- できるだけ上の方の層だけいじって済ませたい
 - 特にmodelは絶対に変えたくない
   - serviceだね
 - 新しく、model 層の album.go に AlbumWithSingerInformation を追加 
   - {"id":1,"title":"Alice's 1st Album","singer":{"id":1,"name":"Alice"}} の形式
   - singer の中には Singer 構造体が入る
   - service は repositoryから Album を受け取って、AlbumWithSingerInformation を返すようにする
 - 実装完了
  - albumのserviceはsingerを見れる必要があったので、そのように変更
  - getAllは、albumで受け取ったものを逐次変更していくように実装
    - パフォーマンスはわからない（遅そう）


## 課題5

実装についての課題点

 - POSTについて
   - 空を投げ込めてしまう
  - ID のunique性について
    - すでにDBにあるsingerと同じIDを持つsingerをPOSTで追加すると上書きされてしまう
      - API側でIDがユニークであることを保証できた方がうれしそうなので、POSTにそのチェックが入れられるとよいか
      - すでに存在するIDの歌手を追加しようとすると、409などエラーを吐くようにするといいかもしれない
  - 冪等性について
    - POST とか DELETE を連打したときどういうふるまいをするのが理想か？
      - POSTは上記の通り
      - DELETEはこのままでよさそう
  - 将来的にsinger-albumの関係は多対多になりうるのでは？
    - 現状だと1つのalbumに1つのsingerを前提としているが、ユニット曲とかで2つ以上のsingerを割り当てる必要があるとこのままではうまくいかない
  - 考えることリスト
    - めちゃくちゃなデータを投げ込んで壊れないか（エラーハンドリングは適切か）
    - 動作は高速か
    - あるケースでバグが発生するとか
  - albumに割り当てられているsingerがDBにないときどうするか
    - 実生活だと、エラーを吐かれるより「不明な歌手」とかで埋められているケースが多そう（CDとか）

改善点（こうなったらいいな）
  - 歌手からアルバムを検索できると嬉しそう
   - クエリ文字列でalbums/singer=?みたいな
  - 名前検索など（部分一致までできるとなおよし）